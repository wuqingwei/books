

包括四部分，概述、需要进行的活动、需要输出的文档和记录、嵌入式软件应用要点

### 概述

该标准的核心目标是确保医疗器械软件的**安全性和有效性**，通过定义医疗器械软件的生命周期过程来达到这一目标。

- **适用范围**

    - 本标准适用于**医疗器械软件的开发和维护**。
    - 它涵盖的软件包括：**作为医疗器械组成部分**的软件、**本身就是医疗器械**的软件，以及**用于医疗器械开发或维护**的软件。
    - 无论软件是以何种方式存储（例如，固件、只读存储器、可擦可编程只读存储器、硬盘驱动器、CD-ROM）或部署（例如，在网络、医疗信息学系统或其他系统中运行）的，本标准都适用。
    - 值得注意的是，本标准**不涵盖**将软件嵌入医疗器械中时，通过适当的质量管理体系进行控制以及满足其他适用要求的活动。

- **与相关标准的协同**

    - **质量管理体系**：本标准要求制造商应建立并应用**质量管理体系**来控制软件生存周期过程。它与**YY/T 0287**（医疗器械 质量管理体系 用于法规的要求）和 **ISO/IEC 12207**（软件生存周期过程）兼容。
    - **风险管理**：本标准与**YY/T 0316**（医疗器械风险管理对医疗器械的应用）紧密关联，要求制造商在软件生命周期过程中应用风险管理过程。**软件安全分级**是基于风险分析的结果。
    - **PEMS (可编程电气医用系统)**：本标准确定的软件要求是**IEC 60601-1**对PEMS要求的**补充和兼容**。它专注于软件自身的生命周期过程，而 IEC 60601-1 关注 PEMS 的系统层面（例如，整体确认计划，而本标准不涵盖 PEMS 确认计划）。
    - **IEC 61010-1**：本标准与IEC 61010-1是兼容的。

- **软件生命周期过程** 该标准详细定义了医疗器械软件的**软件生存周期过程**，包括：

    - **质量管理体系**：包括质量管理和风险管理。

    - 软件安全分级，根据软件对危险情况的贡献和由此导致的伤害的严重程度，将软件划分为

        A、B、C 三个安全级别

        - **A级**：软件不能促成危险情况，或只促成不导致伤害或非严重伤害的危险情况。
        - **B级**：软件能促成导致非严重伤害的危险情况。
        - **C级**：软件能促成导致严重伤害或死亡的危险情况。
        - **安全级别决定了开发、验证和维护活动的严格程度**。

    - **遗留软件 (SOUP)**：对**未知来源软件**（即已开发且记录不完整或未按本标准开发的软件）有专门的要求。制造商需要对其进行**风险管理**和集成控制。

    - **软件开发过程**：包括软件开发策划、软件需求分析、软件体系结构设计、软件详细设计、软件单元的实现和验证、软件集成和集成测试、软件系统测试以及软件在系统级应用的发布。

    - **软件维护过程**：包括建立软件维护计划、问题和修改分析、修改的实施。

    - **软件风险管理过程**：贯穿于整个软件生命周期，包括识别促成危险情况的软件项、确定危险控制措施、验证危险控制措施的有效性以及软件变更的风险管理。

    - **软件配置管理过程**：包括配置标识、变更控制和配置状态报告。

    - **软件问题解决过程**：包括编写问题报告、调查问题、通知相关方、使用变更控制过程、保持记录、分析问题的趋势、验证问题解决。

- **软件项的划分** 在复杂的嵌入式系统中，医疗器械软件可能由多个具有不同安全级别的**软件项**组成。制造商在进行软件体系结构设计时，需要根据各个软件项对风险情况的影响和功能独立性，**合理划分软件项**，并为其分配相应的安全级别。例如，一个C级软件系统可以包含A、B、C级等不同安全级别的软件项。

    **配置项就是医疗器械软件中需要被严格管理和控制的任何可独立识别的组成部分或相关文档，以确保其在整个生命周期中的完整性、版本控制和可追溯性**

### 软件生存周期过程中各项主要活动

#### 1. 软件开发过程

软件开发过程包含从策划到发布的多个活动，通常按以下顺序进行：

- 软件开发策划 (Software development planning)

     [5.1]

    - 制造商应建立一项或多项**软件开发计划**。
    - 该计划应明确**软件系统的范围、规模和软件安全级别**的软件开发活动。
    - 计划中应规定**软件开发所用的生存周期模型**。
    - 应说明各种活动的进程和交付物，以及在软件中实施的**系统测试**和**风险控制措施**。
    - 制造商应考虑软件项是否包含**未知来源软件（SOUP）**。
    - 应**保持软件开发计划的更新**。

- 软件需求分析 (Software requirements analysis)

     [5.2]

    - 制造商应**定义来自系统需求的软件需求**。
    - 软件需求内容应包括：**功能和性能需求**、物理特性、计算环境、硬件/软件输入输出、软件系统的安全需求、敏感信息泄露相关的需求、用户可访问性、以及法规要求等。
    - 制造商应确保软件风险控制措施包含在适当的医疗器械软件需求中。
    - 制造商应**对医疗器械风险进行再评价**。
    - 必要时应**更新需求**。
    - 应通过验证来**形成软件**。

- 软件体系结构设计 (Software architecture design)

     [5.3]

    - 制造商应将**软件需求转换为体系结构**。
    - 应**识别所有软件项** [Previous response, based on source 20] 以及**软件项与外部组件之间的接口**。
    - 如果识别出未知来源软件，制造商应**规定其功能和性能需求**，并将其源头追溯到正常功能所需的最低层面。
    - 应**识别与软件项相关的危险情况**，并**制定风险控制措施**。
    - 应**验证体系结构**。

- 软件详细设计 (Software detailed design)

     [5.4]

    - 制造商应将**软件细分为软件单元**。
    - 为**每个软件单元开发详细设计**。
    - 为**接口开发详细设计**。
    - 应**验证详细设计**。

- 软件单元的实现 (Software unit implementation)

     [5.5]

    - 制造商应**实现每个软件单元**。
    - 应**建立软件单元的验证过程**。
    - 应**建立软件单元的验收准则**，包括对危险控制措施的充分性、与软件体系结构的一致性、编码规范或编程标准的符合性等。
    - 应**验证软件单元**。

- 软件集成和集成测试 (Software integration and integration testing)

     [5.6]

    - 制造商应**集成软件单元**。
    - 应**验证软件集成**。
    - 应进行**软件集成测试**，内容包括所要求的软件功能性、风险控制措施的实施、特定时序和性能功能、内部外部接口和预期行为等。
    - 应**评价软件集成测试规程的充分性**。
    - 应进行**回归测试**。
    - 应**记录集成测试**结果。

- 软件系统测试 (Software system testing)

     [5.7]

    - 制造商应为软件系统建立并实施**一组测试**，以验证输入、预期输出、通过/未通过准则和规程。
    - 应**使用软件问题解决过程**处理测试期间发现的异常。
    - **变更后应重新测试**。
    - 应**评价软件系统测试规程的适宜性**。
    - 应**记录软件系统测试**信息。

- 软件在系统级别应用的发布 (Software release)

     [5.8]

    - 制造商应**确保软件验证已完成**。
    - 应**评价已知的剩余异常**，以确保其促成不可接受的风险。
    - 应**将所发布的版本形成文件**。
    - 应**将所发布的软件创建过程形成文件**。
    - 应**确保所有活动和任务的完成**。
    - 应**将软件归档**。
    - 应**确保所发布的软件可交付性**。

#### 2. 软件维护过程 (Software Maintenance Process)

软件维护旨在确保医疗器械软件在发布后的持续安全性和有效性。

- 建立软件维护计划 (Establish a software maintenance plan)

     [6.1]

    - 制造商应为医疗器械软件的发布后维护**制定计划**。
    - 计划应说明维护的规程，包括接收、评价、解决、新版本发布、使用软件风险管理过程、使用软件问题解决过程、使用软件配置管理过程、升级、缺陷修复、打补丁等。

- 问题和修改分析 (Problem and modification analysis)

     [6.2]

    - 应**形成文件并评价反馈**，确定已发布的医疗器械软件是否存在问题。
    - 应**评价问题报告对安全的影响**。
    - 应**使用软件问题解决过程**处理问题。
    - 应**分析所要求的变更**，包括是否与现有系统的接口相关。
    - 应**批准变更要求**。
    - 应与用户和监管机构**沟通**。

- 修改的实施 (Implementation of modifications)

     [6.3]

    - 制造商应**使用已建立的实施修改规程**。
    - 修改后应**再发布软件系统**。

#### 3. 软件风险管理过程 (Software Risk Management Process)

风险管理过程贯穿整个软件生存周期，以识别、评估和控制与软件相关的风险。

- 识别促成危险情况的软件分析 (Analysis of software that contributes to hazardous situations)

     [7.1]

    - 制造商应**识别可能促成危险情况的软件项**。
    - 应**识别促成危险情况的潜在原因**，例如不正确或不完整的功能特性、软件缺陷、来自已知来源的未知缺陷或预期异常、以及可能导致危险情况的已知缺陷或预期异常。
    - 如果发现**未知来源软件的已知缺陷或预期异常**可能导致危险情况，制造商应**进行评价**。
    - 应**将原因形成文件**。

- 风险控制措施 (Risk control measures)

     [7.2]

    - 制造商应**确定风险控制措施**。
    - 应在软件中**实施风险控制措施**。

- 验证风险控制措施 (Verification of risk control measures)

     [7.3]

    - 制造商应**验证所实施的风险控制措施**。
    - 应**将追溯性形成文件**。
    - 应**编写风险控制报告**。

- 软件变更的风险管理 (Risk management of software changes)

     [7.4]

    - 制造商应对医疗器械软件（包括**未知来源软件**）的变更进行**分析**，以确定其是否修改了可能造成危险情况的现有控制措施。
    - 应**分析软件变更对现有危险情况的影响**。
    - 应**基于子分析实施风险管理活动**。

#### 4. 软件配置管理过程 (Software Configuration Management Process)

配置管理确保软件及其文档的完整性，并控制其变更。

- 配置标识 (Configuration identification)

     [8.1]

    - 制造商应建立**配置标识的方法**。
    - 应**标识未知来源软件**，包括其来源、供应商、版本、日期和文件名称。
    - 应**标识系统配置**。

- 变更控制 (Change control)

     [8.2]

    - 应**评估和批准变更请求**。
    - 应**实施变更**。
    - 应**验证变更**。
    - 应**规定为变更的可追溯性**。

- 配置状态报告 (Configuration status reporting)

     [8.3]

    - 制造商应**保留包括软件配置在内的受控配置历史的可检索记录**。

#### 5. 软件问题解决过程 (Software Problem Resolution Process)

问题解决过程处理软件开发和维护中发现的所有问题。

- 编写问题报告 (Problem reporting)

     [9.1]

    - 制造商应为医疗器械软件中发现的每个问题**编写问题报告**。

- 调查问题 (Problem investigation)

     [9.2]

    - 制造商应对问题进行**调查**，包括识别原因、利用风险管理过程和安全相关性、将调查和评价结果形成文件等。
    - 应为纠正问题所需的措施**创建变更请求**。

- 通知相关方 (Notification to interested parties)

     [9.3]

    - 制造商应将问题**通知相关方**。

- 使用变更控制过程 (Use of change control process)

     [9.4]

    - 制造商应**按照变更控制过程的规定实施所有变更请求**。

- 保持记录 (Record retention)

     [9.5]

    - 制造商应**保持问题报告及其解决情况的记录**。

- 分析问题的趋势 (Analysis of problem trends)

     [9.6]

    - 制造商应对问题报告进行**分析**，以从中发现问题的趋势。

- 验证问题的解决 (Verification of problem resolution)

     [9.7]

    - 制造商应**验证问题是否已解决**。

- 测试文档的内容 (Content of test documentation)

     [9.8]

    - 测试文档应包括测试结果、发现的异常、所测试软件的版本、相关软件和软件的测试配置、相关测试工具、测试日期和测试者的身份等。

### 输出的文档和记录

1. **质量管理体系相关文档**
    - **质量管理体系文件**：制造商应建立并应用质量管理体系来控制软件生存周期过程，其具体要求与 YY/T 0287 兼容。尽管标准没有直接列出QMS的具体文档，但要求软件生存周期过程应在质量管理体系的控制之下。
    - **文档的策划**：在软件开发计划中，应包括或引用有关在软件生存周期中要生成的文件信息，如标题、目的、开发、评审、批准和修改的规程和职责等。
    - 遗留软件的版本和继续使用的理由形成文件
2. **软件开发过程文档**
    - **软件开发计划**：这是软件开发活动的总体规划，包含开发过程视图、交付物、体系结构、确认计划、测试计划、风险控制措施等。
    - **软件需求文档**：由医疗器械的软件需求形成，应包含功能和性能要求、物理特性、软件输入/输出、接口、安全要求等内容，并需将风险控制措施包含在软件需求中。验证软件需求并形成文件
    - **软件体系结构文档**：将软件需求转化为体系结构文档，并形成软件项之间的接口文件。描述软件的结构并识别所有软件项（目前xxx概要设计包含部分体系结构内容），验证软件体系结构并形成文件
    - **软件详细设计文档**：软件细分为软件单元，将软件单元详细设计形成文档，并包括接口开发详细设计。验证详细设计并形成文件
    - *软件单元验证结果记录*：对每个软件单元的实现进行验证，并保留相应的验证结果。
    - *软件集成计划*：对软件集成和集成测试的策划。
    - *回归测试*
    - *集成测试记录*：包含测试结果、发现的反常、被测试软件的版本、相关硬件和软件的测试配置等。
    - **软件系统测试记录**：包含测试结果、发现的反常、软件版本、相关硬件和软件配置、测试工具、测试日期和测试者身份等。
    - **已知的剩余反常形式**：在软件发布前应评估所有已知的剩余反常，确保风险可接受。
    - **所发布的版本文件**：发布医疗器械软件的版本文件。
    - **所发布的软件创建过程形成文件**：描述已发布软件的创建过程。
    - **软件归档**：确保所发布软件可用于后续的维护或重新发布。
3. **软件维护过程文档**
    - **软件维护计划**：描述接收、评价、修改、验证、发布、问题管理、风险管理和配置管理等活动的规程。
    - **问题报告**：记录软件中发现的问题，包括严重性、安全或信息安全的影响等。
    - **修改实施规程**：建立并遵循修改实施的规程。
4. **软件风险管理过程文档**
    - **风险分析报告**：识别软件项可能促成的危险情况及其潜在原因。
    - **风险控制措施文档**：描述在软件中实施的风险控制措施。
    - **风险控制措施验证结果**：验证所实施的危险控制措施的有效性。
    - **风险管理报告**：记录软件风险管理过程的整体情况。
    - **软件变更风险管理分析**：对与医疗器械软件安全相关的变更进行分析，并分析其对现有风险控制措施的影响。
5. **软件配置管理过程文档**
    - **配置标识记录文档**：用于唯一标识配置项及其版本信息。
    - 以下的关系和依赖性记录
        - *变更请求*：记录对医疗器械软件所做变更的请求。
        - *有关的问题报告*
        - *变更请求的批准*
    - **变更实施记录**：记录变更的实施情况。（软件项和软脚虾的安全级别）
    - **配置状态报告**：用于报告配置项的当前状态和历史记录。
6. **软件问题解决过程文档**
    - **问题报告**：如前所述，用于记录软件中发现的问题。可以是发布之前或之后，组织内部或外部
    - **问题调查记录**：记录对问题进行调查的结果，包括溯源性和评估结果。
    - 解决问题所创建的变更请求，或不采取措施的理由形成文件
    - **问题解决记录**：保持对问题报告和解决情况的记录。
    - **问题趋势分析报告**：分析从问题报告中发现的趋势。
    - 变更之后的测试文档

### 嵌入式软件应用要点

• **标准范围的界定与质量管理体系的协同** ，**本标准不涵盖将软件嵌入医疗器械中时，通过适当的质量管理体系进行控制以及满足其他适用要求的活动**。这意味着，当医疗器械软件是嵌入式软件时，其软件生命周期过程（如开发、维护等）应遵循 YY/T 0664-2020 的要求，但该嵌入式软件与硬件的集成、以及在整个医疗器械系统层面对其进行的质量管理控制，需要通过**其他适用的质量管理体系**来覆盖和管理，因此，在实施过程中，制造商需要确保有一个更全面的质量管理体系来协调这些未被 YY/T 0664-2020 直接涵盖的活动。

• **与可编程电气医用系统 (PEMS) 相关的要求** 嵌入式软件通常是可编程电气医用系统 (PEMS) 的组成部分，本标准所确定的软件要求是 IEC 60601-1:2005 + IEC 60601-1:2005/AMD1:2012 对 PEMS 要求的补充，并且与这些要求兼容

  ◦ 在实施时，制造商应理解 YY/T 0664-2020 主要聚焦于软件自身的生命周期过程。例如，本标准确定的软件开发计划，PEMS 确认计划属于系统层面，可能会涵盖软件项，但本标准本身并不涵盖 PEMS 确认计划

  ◦ 对于 PEMS 软件子系统的要求，本标准在软件开发策划、需求分析、体系结构设计、详细设计、单元实现与验证等方面与 IEC 60601-1 的相关要求保持一致或提供支持

  ◦ 然而，本标准并未涵盖 PEMS 软件配置项的控制，这意味着 PEMS 整体的配置管理，尤其是涉及软硬件交互和系统级配置的部分，可能需要参考 IEC 60601-1 等相关标准来执行。

  ◦ 因此，对于嵌入式软件，需要同时考虑 YY/T 0664-2020 对软件生命周期过程的具体要求，以及 IEC 60601-1 等其他 PEMS 相关标准在系统层面（包括软硬件集成、系统验证等）的要求。

• **未知来源软件 (SOUP) 的处理** 嵌入式软件中可能会包含来自第三方或现成的组件，这些组件可能被定义为“未知来源软件 (SOUP)”

  本标准详细定义了 SOUP，并要求制造商对其进行风险管理和集成控制。在实施时，需要特别关注对这些 SOUP 组件的识别、评估和管理，以确保它们符合医疗器械的安全性和性能要求

• **软件项的划分和安全级别** 在复杂的嵌入式系统中，医疗器械软件可能由多个具有不同安全级别的软件项组成，例如，一个 C 级软件系统可以包含 A、B、C 级等不同安全级别的软件项。制造商在进行软件体系结构设计时，需要根据各个软件项对风险情况的影响和功能独立性，合理划分软件项，并为其分配相应的安全级别。这将直接影响到每个软件项所需遵循的开发、测试和维护活动的严格程度。

